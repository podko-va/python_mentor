
üéì –£—Ä–æ–∫ 4.3 ‚Äî –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Data Aggregation)

üü¢ –í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:
–°–µ–≥–æ–¥–Ω—è –º—ã –Ω–∞—É—á–∏–º—Å—è —Å–≤–æ–¥–∏—Ç—å –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –≤ –∫—Ä–∞—Ç–∫–∏–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–≤–æ–¥–∫–∏. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–¥–∞–∂ –±—ã–ª–æ –≤ –∫–∞–∂–¥–æ–º —Ä–µ–≥–∏–æ–Ω–µ? –ö–∞–∫–æ–π —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —É —É—á–µ–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ?

üìå –¶–µ–ª—å: –ù–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –∏ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Pandas.

---

üî∂ 1. –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

- **groupby()** ‚Äî –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º.
- **–ê–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
  - sum() ‚Äî —Å—É–º–º–∞
  - mean() ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  - count() ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π
  - min(), max(), std(), median(), –∏ –¥—Ä.

---

üî∂ 2. –ü—Ä–∏–º–µ—Ä 1 ‚Äî –ø—Ä–æ—Å—Ç–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞

```python
import pandas as pd

data = {'–ö–∞—Ç–µ–≥–æ—Ä–∏—è': ['A', 'B', 'A', 'B', 'C'],
        '–ó–Ω–∞—á–µ–Ω–∏–µ': [10, 20, 30, 40, 50]}
df = pd.DataFrame(data)

# –°—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
grouped = df.groupby('–ö–∞—Ç–µ–≥–æ—Ä–∏—è').sum()
print(grouped)
```

üß† –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
–ó–¥–µ—Å—å –º—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç–æ–ª–±—Ü—É "–ö–∞—Ç–µ–≥–æ—Ä–∏—è" –∏ –ø–æ—Å—á–∏—Ç–∞–ª–∏ —Å—É–º–º—É –∑–Ω–∞—á–µ–Ω–∏–π. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ ‚Äî —Ç–∞–±–ª–∏—Ü–∞, –≥–¥–µ —É –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–¥–Ω–æ –∏—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

---

üî∂ 3. –ü—Ä–∏–º–µ—Ä 2 ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π

```python
result = df.groupby('–ö–∞—Ç–µ–≥–æ—Ä–∏—è').agg({'–ó–Ω–∞—á–µ–Ω–∏–µ': ['sum', 'mean', 'count']})
print(result)
```

‚úç –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:
–ú—ã —É–∫–∞–∑–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π ‚Äî –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å 3 —Å—Ç–æ–ª–±—Ü–∞–º–∏: —Å—É–º–º–∞, —Å—Ä–µ–¥–Ω–µ–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ.

---

üìã –ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-----------|----------|
| A         | 10       |
| B         | 20       |
| A         | 30       |
| B         | 40       |
| C         | 50       |

‚û° –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ groupby + agg:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—É–º–º–∞ | –°—Ä–µ–¥–Ω–µ–µ | –ö–æ–ª-–≤–æ |
|-----------|-------|---------|--------|
| A         | 40    | 20.0    | 2      |
| B         | 60    | 30.0    | 2      |
| C         | 50    | 50.0    | 1      |

---

üß© 4. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:
1. –°–æ–∑–¥–∞–π—Ç–µ DataFrame —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ "–ü—Ä–µ–¥–º–µ—Ç", "–û—Ü–µ–Ω–∫–∞", "–°—Ç—É–¥–µ–Ω—Ç".
2. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É.
3. –ù–∞–π–¥–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å–¥–∞–≤–∞–ª–∏ –∫–∞–∂–¥—ã–π –ø—Ä–µ–¥–º–µ—Ç.

---

üß™ 5. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:
- –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –º–µ—Ç–æ–¥ groupby()?
- –í —á–µ–º –æ—Ç–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–π mean() –∏ count()?
- –ö–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π –∫ –≥—Ä—É–ø–ø–∞–º?
- –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–≤—É–º —Å—Ç–æ–ª–±—Ü–∞–º?

---

üì¶ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç—Ä—é–∫:
–ú–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:

```python
df.groupby("–ö–∞—Ç–µ–≥–æ—Ä–∏—è").sum().sort_values(by="–ó–Ω–∞—á–µ–Ω–∏–µ", ascending=False)
```

---

üéØ –ò—Ç–æ–≥:
–ê–≥—Ä–µ–≥–∞—Ü–∏—è ‚Äî –≤–∞–∂–Ω–µ–π—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ –ø–æ–º–æ–≥–∞–µ—Ç –¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã –∏ —É–ø—Ä–æ—â–∞–µ—Ç –æ—Ç—á–µ—Ç—ã.

